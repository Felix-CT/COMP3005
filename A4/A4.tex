\documentclass[a4 paper]{article}
% Set target color model to RGB
\usepackage[inner=2.0cm,outer=2.0cm,top=2.5cm,bottom=2.5cm]{geometry}
\usepackage{setspace}
\usepackage[rgb]{xcolor}
\usepackage{verbatim}
\usepackage{subcaption}
\usepackage{amsgen,amsmath,amstext,amsbsy,amsopn,tikz,amssymb,tkz-linknodes}
\usepackage{fancyhdr}
\usepackage[colorlinks=true, urlcolor=blue,  linkcolor=blue, citecolor=blue]{hyperref}
\usepackage[colorinlistoftodos]{todonotes}
\usepackage{rotating}
%\usetikzlibrary{through,backgrounds}
\hypersetup{%
pdfauthor={Ashudeep Singh},%
pdftitle={Assignment 4},%
pdfkeywords={Tikz,latex,bootstrap,uncertaintes},%
pdfcreator={PDFLaTeX},%
pdfproducer={PDFLaTeX},%
}
%\usetikzlibrary{shadows}
% \usepackage[francais]{babel}
\usepackage{booktabs}
\input{macros.tex}


\begin{document}
\homework{Assignment \#4}{Due: Friday November 19, 2021 (11:59 PM)}{Ahmed El-Roby}{}{FÃ©lix Cardinal Tremblay}{101141593}
\textbf{Instructions}: Read all the instructions below carefully before you start working on the assignment, and before you make a submission.
\begin{itemize}
    \item The accepted format for your submission is pdf only.
    \item If you use the tex file, make sure you edit line 28 to add your name and ID. Only write your solution and do not change anything else in the tex file. If you do, you will be penalized.
    \item \item Late submissions are allowed for 24 hours after the deadline above with a penalty of 10\% of the total grade of the assignment. Submissions after more than 24 are not allowed.
\end{itemize}

\problem{1:}{3}
In class, we showed that functional dependencies are transitive. That is, if $X \rightarrow Y$ and $Y \rightarrow Z$, then $X \rightarrow Z$. Assume a new proposed rule: If $X \rightarrow Y$ and $Z \rightarrow Y$, then $X \rightarrow Z$. Prove that this rule is incorrect.\\\\
Here is a counter example:
\begin{center}
  \begin{tabular}{|c|c|c|}
   \hline
    X & Y & Z\\ [0.5ex]
   \hline\hline
   a & 1 & b\\
   \hline
   a & 1 & c\\
   \hline
   b & 1 & a\\
   \hline
  \end{tabular}
\end{center}
$X\rightarrow Y$ is valid as there is no situation where the $X$ values are the same, but the values of $Y$ is different.\\
$Z\rightarrow Y$ is valid as there is no situation where the $Z$ values are the same, but the values of $Y$ is different.\\
$X\rightarrow Z$ is invalid, as we have the tuples $(a,b),(a,c)$, so $X$ cannot be functionally dependent on $Z$



\problem{2:}{3}
How can you use functional dependencies to represent the constraint that a relationship between two entity sets $X$ and $Y$ is one-to-many from $X$ to $Y$.\\\\
You would denote it as $Y\rightarrow X$. This is because multiple values of $Y$ can have the same value of $X$, without the constraint being violated. On the other hand, if we were to have different values of $X$ for the same value of $Y$, the constraint (and the relationship) would be violated.


\problem{3:}{8}
Consider the following relation $R = \{A, B, C, D, E\}$ and the following set of functional dependencies \\$F = \{
\\A \rightarrow BC\\
CD \rightarrow E\\
B \rightarrow D\\
E \rightarrow A\}$\\
Compute $B^{+}$. Is $R$ in BCNF? If not, give a lossless decomposition of $R$ into BCNF. Show your work for all previous questions.\\\\
\begin{align*}
  &\text{result} = B\\
  &B\rightarrow D: \text{ result} = BD
\end{align*}
$R$ is not in BCNF. This is because for $R$ to be in BCNF, we need the all of the values on the left side of the arrows to be superkeys. Since $B$ is not a superkey, it means that $R$ cannot be in BCNF.\\\\
We will begin by listing out all of the closures of the Left hand side of the arrows.
$A^+$:
\begin{align*}
  &\text{result} = A\\
  &A\rightarrow BC: \text{ result} = ABC\\
  &B\rightarrow D: \text{ result} = ABCD\\
  &CD\rightarrow E: \text{ result} = ABCDE
\end{align*}
and thus $A^+\subseteq R$.\\
$(CD)^+$:
\begin{align*}
  &\text{result} = CD\\
  &CD\rightarrow E: \text{ result} = CDE\\
  &E\rightarrow A: \text{ result} = ACDE\\
  &A\rightarrow BC: \text{ result} = ABCDE
\end{align*}
and thus $(CD)^+\subseteq R$.\\
$E^+$:
\begin{align*}
  &\text{result} = E\\
  &E\rightarrow A: \text{ result} = AE\\
  &A\rightarrow BC: \text{ result} = ABCE\\
  &B\rightarrow D: \text{ result} = ABCDE\\
\end{align*}
and thus $(E)^+\subseteq R$.\\
So, finally we have:
\begin{align*}
  &A^+: ABCDE\\
  &CD^+: ABCDE\\
  &E^+: ABCDE\\
  &B^+: BD
\end{align*}

So, we need to create two relation such that A, CD, E, and B are primary keys, and that the intersection of the two relations is a primary key of at least one of the relations. We know that for $B$ to be a primary key, we need it to be in a relation that only contains $B$ and $D$. Therefore, we know that $R_1=\{B,D\}$. Next, since the closure of the other three attributes is $R$, it does not matter which values we choose, as our remaining values determine all values. So, we can choose it as the following: $R_2=\{A,B,C,E\}$. Since $R_1\cup R_2={B}$, and $B$ is a superkey for $R_2$, we know it must be lossless.\\\\
Since $A^+, CD^+$ and $E^+$ are superkeys for $R_2$ and $B$ is a superkey for $R_1$, we know the decomposition must be in BCNF.






\problem{4:}{4}
Give a lossless, dependency-preserving decomposition into 3NF of schema $R$ in Q3.\\\\

We start with the following functional dependencies:
\\$F = \{
\\A \rightarrow BC\\
CD \rightarrow E\\
B \rightarrow D\\
E \rightarrow A\}$\\
We want to find the canonical cover, that is, $F_c$.
The dependencies $A\rightarrow BC$ and $E\rightarrow A$ can be replaced by $E\rightarrow ABC$. Thus, our current $F_c$ is:\\
$\{
\\E \rightarrow ABC\\
CD \rightarrow E\\
B \rightarrow D\}$\\

Next, we notice that $E \rightarrow ABC$ and $CD \rightarrow E$ can be replaced by $CD\rightarrow ABCE$, so $F_c$ is:\\
$\{
\\CD \rightarrow ABCE\\
B \rightarrow D\}$\\

%THIS COULD DEFINITELY BE WRONG
%Since we have $C$ on both sides, we can then show $CD \rightarrow ABCED=\rightarrow ABED$

Since there are no extraneous attributes in the functional dependencies:
$F_c=\{B\rightarrow D, CD\rightarrow ABCE$\\
After the first loop of the algorithm, we would get the following relations:\\
$R_1:\{A,B,C,D,E\}$, $R_2:\{B,D\}$
Then, because $R_2\subseteq R_1$, we can delete $R_2$.

\problem{5:}{4}
Assume the following decomposition of $R$ in Q3: $R_{1}(A, B, E)$ and $R_{2}(C, D, E)$. Is this decomposition lossy or lossless? Why? Show your work in detail.\\\\
For the decomposition of a relation to be lossless, we need one of the two following conditions to be true: $R_1 \cap R_2\rightarrow R_1$, or $R_1 \cap R_2\rightarrow R_2$.
Since $R_1\cap R_2=\{\}$, this means that the decomposition must be lossy.



\problem{6:}{22}
Consider the following relation $R(A, B, C, D, E, G)$ and the set of functional dependencies \\$F = \{
\\A \rightarrow BCD\\
BC \rightarrow DE\\
B \rightarrow D\\
D \rightarrow A\}$\\

\noindent Note: Show the steps for each answer.

\subproblem{a} Compute $B^{+}$. \indent (4 points)\\
\begin{align*}
  &\text{result} = B\\
  &B\rightarrow D: \text{ result} = BD\\
  &D\rightarrow A: \text{ result} = ABD\\
  &A\rightarrow BCD: \text{ result} = ABCD\\
  &BC\rightarrow DE: \text{ result} = ABCDE\\
\end{align*}
so, our final result is $B^+=\{A,B,C,D,E\}$




\subproblem{b} Prove (using Armstrong's axioms) that $AG$ is superkey. \indent (4 points)\\
We can start with the following:


\subproblem{c} Compute $F_{c}$. \indent (6 points)\\



\subproblem{d} Give a 3NF decomposition of the given schema based on a canonical cover. \indent (4 points)



\subproblem{e} Give a BCNF decomposition of the given schema based on $F$. Use the first functional dependency as the violator of the BCNF condition. \indent (4 points)\\



\problem{7:}{6}
Given the following set of functional dependencies:\\
$A \rightarrow BC$\\
$B \rightarrow AC$\\
$C \rightarrow AB$\\
Show that it is possible to find more than one unique canonical cover for this set.



\problem{8}{7}
Consider the schema $R = (A, B, C, D, E, G)$ and the set $F$ of functional dependencies:\\
$A \rightarrow BC$\\
$BD \rightarrow E$\\
$CD \rightarrow AB$\\
Use the BCNF decomposition algorithm to find a BCNF decomposition
of $R$. Start with $A \rightarrow BC$. Explain your steps. Is this decomposition lossy or lossless? Is it dependency-preserving?



\problem{9:}{3}
As discussed in class, SQL does not support functional dependency constraints. But it supports materialized views. Assume that the DBMS maintains the materialized view immediately. Given a relation $R(W, X, Y, Z)$, how would you use materialized views to enforce the functional dependency $W \rightarrow Z$?



\end{document}


\end{document}
